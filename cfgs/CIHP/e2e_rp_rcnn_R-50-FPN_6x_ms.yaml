# bbox_AP: 68.1/92.5/75.9/3.5/47.9/71.2;
# parsing: (mIoU:60.2/AP50:74.1/APvol:59.5/PCP50:64.9)

### soft-nms + bbox voting + box aug + parsing aug ###
# bbox_AP: 73.1/94.4/81.1/10.5/52.4/76.4;
# parsing: (mIoU:61.8/AP50:77.2/APvol:61.2/PCP50:70.5)
PIXEL_MEANS: [102.9801, 115.9465, 122.7717]
PIXEL_STDS: [1.0, 1.0, 1.0]
CKPT: 'ckpts/CIHP/e2e_rp_rcnn_R-50-FPN_6x_ms'
MODEL:
  FPN_ON: True
  SEMSEG_ON: True
  FASTER_ON: True
  PARSING_ON: True
  NUM_CLASSES: 2
  CONV1_RGB2BGR: False  # caffe style
BACKBONE:
  CONV_BODY: "resnet"
  RESNET:  # caffe style
    LAYERS: (3, 4, 6, 3)
FPN:
  USE_GN: True
SEMSEG:
  SEMSEG_NUM_CLASSES: 20
  ROI_SEMSEG_HEAD: 'fused_head'
  SEMSEG_LOSS_WEIGHT: 2.0
  SEMSEG_HEAD:
    FUSION_LEVEL: 1  # P2
    USE_GN: True
RPN:
  ANCHOR_STRIDE: (4, 8, 16, 32, 64)
  PRE_NMS_TOP_N_TRAIN: 2000
  PRE_NMS_TOP_N_TEST: 1000
  POST_NMS_TOP_N_TEST: 1000
  FPN_POST_NMS_TOP_N_TEST: 1000
FAST_RCNN:
  ROI_XFORM_RESOLUTION: (7, 7)
  ROI_XFORM_SAMPLING_RATIO: 2
PRCNN:
  ROI_PARSING_HEAD: "roi_gce_head"
  NUM_PARSING: 20
  ROI_STRIDES: [4]
  ROI_SIZE_PER_IMG: 16
  ROI_XFORM_RESOLUTION: (32, 32)
  ROI_XFORM_SAMPLING_RATIO: 2
  RESOLUTION: (128, 128)
  LOSS_WEIGHT: 2.0  # double loss weight
  PARSINGIOU_ON: True
  GCE_HEAD:
    NUM_CONVS_AFTER_ASPPV3: 4
    USE_NL: True
    USE_GN: True
  PARSINGIOU:
    CONV_DIM: 128
    MLP_DIM: 256
SOLVER:
  WEIGHT_DECAY: 0.0001
  BASE_LR: 0.02
  GAMMA: 0.1
  WARM_UP_FACTOR: 0.0001
  WARM_UP_ITERS: 1000
  MAX_ITER: 270000
  STEPS: [240000, 260000]
TRAIN:
  WEIGHTS: weights/pytorch-model/caffe-model/resnet50_caffe.pth
  DATASETS: ('CIHP_train', )
  SCALES: (512, 640, 704, 768, 800, 864)
  MAX_SIZE: 1400
TEST:
  DATASETS: ('CIHP_val',)
  SCALE: 800
  MAX_SIZE: 1333

  # -- Visualization outputs -- #
#VIS:
#  ENABLED: True
#  VIS_TH: 0.5
#  SHOW_PARSS:
#    PARSING_ALPHA: 0.7
#  SHOW_CLASS:
#    FONT_SCALE: 1.0

  # -- Test time augmentation -- #
#  SOFT_NMS:
#    ENABLED: True
#  BBOX_VOTE:
#    ENABLED: True
#    VOTE_TH: 0.9
#  BBOX_AUG:
#    ENABLED: True
#    H_FLIP: True
#    SCALES: (400, 500, 600, 700, 900, 1000, 1100, 1200)
#    MAX_SIZE: 2000
#  PARSING_AUG:
#    ENABLED: True
